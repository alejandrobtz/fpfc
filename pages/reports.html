<html lang="es">
  <head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>Reportes</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <link rel="stylesheet" href="../styles.css" />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#fbfaf9] group/design-root overflow-x-hidden" style='font-family: "Work Sans", "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f1efe9] px-10 py-3">
          <div class="flex items-center gap-8">
            <div class="flex items-center gap-4 text-[#191610]">
              <div class="h-8 w-8">
                <img src="../img/fpfc-logo.png" alt="FPFC Logo" class="h-full w-full object-contain fpfc-logo" />
              </div>
            </div>
            <div class="flex items-center gap-9">
              <a class="text-[#191610] text-sm font-medium leading-normal" href="./dashboard.html">Dashboard</a>
              <a class="text-[#191610] text-sm font-medium leading-normal" href="./inventory.html">Inventario</a>
              <a class="text-[#191610] text-sm font-medium leading-normal" href="./users.html">Seguridad</a>
            </div>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <div class="relative">
              <button
                id="profileBtn"
                class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 bg-[#f1efe9] text-[#191610] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
              >
                <div class="text-[#191610]" data-icon="User" data-size="20px" data-weight="regular">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="currentColor" viewBox="0 0 256 256">
                    <path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.8,166.78,40.33,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,0,1,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path>
                  </svg>
                </div>
                <span>Perfil</span>
              </button>
              <div
                id="profileDropdown"
                class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 hidden"
              >
                <a
                  href="./perfil.html"
                  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                >
                  Perfil
                </a>
                <a
                  href="#"
                  onclick="logout()"
                  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                >
                  Cerrar Sesión
                </a>
              </div>
            </div>
          </div>
        </header>
        <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
            <div class="flex flex-wrap justify-between gap-3 p-4">
              <p class="text-[#191610] tracking-light text-[32px] font-bold leading-tight min-w-72">Generar Reportes</p>
            </div>
            
            <div class="p-4">
              <div class="bg-white rounded-xl border border-[#e3dfd4] p-6">
                <h3 class="text-lg font-bold text-[#191610] mb-4">Configurar Reporte</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <!-- Available Fields Section -->
                  <div>
                    <h4 class="text-md font-semibold text-[#191610] mb-3">Campos Disponibles</h4>
                    <p class="text-sm text-[#8b7e5b] mb-4">Arrastra los campos que deseas incluir en tu reporte</p>
                    
                    <div id="availableFields" class="space-y-2 min-h-[300px] p-4 bg-[#fbfaf9] rounded-lg border-2 border-dashed border-[#e3dfd4]">
                      <div class="field-item" draggable="true" data-field="id">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">ID del Registro</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="nombre">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Nombre/Título</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="año">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Año</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="material">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Material</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="autor">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Autor</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="estado">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Estado de Conservación</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="fecha">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Fecha de Adición</span>
                        </div>
                      </div>
                      
                      <div class="field-item" draggable="true" data-field="notas">
                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-[#e3dfd4] cursor-move hover:bg-[#f1efe9] transition-colors">
                          <div class="text-[#8b7e5b]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256">
                              <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                            </svg>
                          </div>
                          <span class="text-sm font-medium text-[#191610]">Notas</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Selected Fields Section -->
                  <div>
                    <h4 class="text-md font-semibold text-[#191610] mb-3">Campos Seleccionados</h4>
                    <p class="text-sm text-[#8b7e5b] mb-4">Los campos que aparezcan aquí se incluirán en tu reporte</p>
                    
                    <div id="selectedFields" class="min-h-[300px] p-4 bg-[#fbfaf9] rounded-lg border-2 border-dashed border-[#e3dfd4]">
                      <div class="text-center text-[#8b7e5b] text-sm py-20">
                        Arrastra campos aquí para incluirlos en tu reporte
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Report Options -->
                <div class="mt-6 p-4 bg-[#fbfaf9] rounded-lg">
                  <h4 class="text-md font-semibold text-[#191610] mb-3">Opciones del Reporte</h4>
                  
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                      <label class="block text-sm font-medium text-[#191610] mb-2">Formato de Exportación</label>
                      <select id="exportFormat" class="w-full px-3 py-2 border border-[#e3dfd4] rounded-lg focus:outline-none focus:border-[#c39f3c]">
                        <option value="excel">Excel (.xlsx)</option>
                        <option value="csv">CSV (.csv)</option>
                        <option value="pdf">PDF (.pdf)</option>
                      </select>
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-[#191610] mb-2">Ordenar por</label>
                      <select id="sortBy" class="w-full px-3 py-2 border border-[#e3dfd4] rounded-lg focus:outline-none focus:border-[#c39f3c]">
                        <option value="nombre">Nombre</option>
                        <option value="año">Año</option>
                        <option value="fecha">Fecha de Adición</option>
                        <option value="estado">Estado</option>
                      </select>
                    </div>
                    
                    <div>
                      <label class="block text-sm font-medium text-[#191610] mb-2">Orden</label>
                      <select id="sortOrder" class="w-full px-3 py-2 border border-[#e3dfd4] rounded-lg focus:outline-none focus:border-[#c39f3c]">
                        <option value="asc">Ascendente</option>
                        <option value="desc">Descendente</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end gap-3 mt-6">
                  <button
                    onclick="resetReport()"
                    class="px-6 py-2 text-sm font-medium text-[#8b7e5b] border border-[#e3dfd4] rounded-lg hover:bg-[#f1efe9] transition-colors"
                  >
                    Restablecer
                  </button>
                  <button
                    onclick="generateReport()"
                    id="generateBtn"
                    disabled
                    class="px-6 py-2 text-sm font-medium text-white bg-[#c39f3c] rounded-lg hover:bg-[#b08f2a] transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    Generar Reporte
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const profileBtn = document.getElementById('profileBtn');
        const profileDropdown = document.getElementById('profileDropdown');
        const generateBtn = document.getElementById('generateBtn');

        profileBtn.addEventListener('click', function() {
          profileDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
          if (!profileBtn.contains(event.target) && !profileDropdown.contains(event.target)) {
            profileDropdown.classList.add('hidden');
          }
        });

        // Initialize drag and drop
        initializeDragAndDrop();
      });

      function initializeDragAndDrop() {
        const availableFields = document.getElementById('availableFields');
        const selectedFields = document.getElementById('selectedFields');
        const generateBtn = document.getElementById('generateBtn');

        // Add drag event listeners to available fields
        document.querySelectorAll('.field-item').forEach(item => {
          item.addEventListener('dragstart', handleDragStart);
          item.addEventListener('dragend', handleDragEnd);
        });

        // Add drop zone event listeners
        selectedFields.addEventListener('dragover', handleDragOver);
        selectedFields.addEventListener('drop', handleDrop);

        function handleDragStart(e) {
          e.dataTransfer.setData('text/plain', e.target.dataset.field);
          e.target.style.opacity = '0.5';
        }

        function handleDragEnd(e) {
          e.target.style.opacity = '1';
        }

        function handleDragOver(e) {
          e.preventDefault();
          e.currentTarget.style.borderColor = '#c39f3c';
        }

        function handleDrop(e) {
          e.preventDefault();
          const fieldType = e.dataTransfer.getData('text/plain');
          const fieldItem = document.querySelector(`[data-field="${fieldType}"]`);
          
          if (fieldItem && !document.querySelector(`#selectedFields [data-field="${fieldType}"]`)) {
            // Clone the field item
            const clonedItem = fieldItem.cloneNode(true);
            
            // Add remove button
            const removeBtn = document.createElement('button');
            removeBtn.innerHTML = `
              <div class="text-red-500 hover:text-red-700">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256">
                  <path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>
                </svg>
              </div>
            `;
            removeBtn.className = 'ml-auto';
            removeBtn.onclick = function() {
              clonedItem.remove();
              updateGenerateButton();
              updateSelectedFieldsMessage();
            };
            
            clonedItem.querySelector('.flex').appendChild(removeBtn);
            selectedFields.appendChild(clonedItem);
            
            updateGenerateButton();
            updateSelectedFieldsMessage();
          }
          
          e.currentTarget.style.borderColor = '#e3dfd4';
        }

        function updateGenerateButton() {
          const selectedCount = selectedFields.querySelectorAll('.field-item').length;
          generateBtn.disabled = selectedCount === 0;
        }

        function updateSelectedFieldsMessage() {
          const selectedCount = selectedFields.querySelectorAll('.field-item').length;
          const messageDiv = selectedFields.querySelector('.text-center');
          
          if (selectedCount === 0 && messageDiv) {
            messageDiv.style.display = 'block';
          } else if (messageDiv) {
            messageDiv.style.display = 'none';
          }
        }
      }

      function resetReport() {
        if (confirm('¿Estás seguro de que quieres restablecer el reporte?')) {
          const selectedFields = document.getElementById('selectedFields');
          selectedFields.innerHTML = `
            <div class="text-center text-[#8b7e5b] text-sm py-20">
              Arrastra campos aquí para incluirlos en tu reporte
            </div>
          `;
          
          document.getElementById('generateBtn').disabled = true;
        }
      }

      function generateReport() {
        const selectedFields = document.getElementById('selectedFields');
        const fieldItems = selectedFields.querySelectorAll('.field-item');
        const exportFormat = document.getElementById('exportFormat').value;
        const sortBy = document.getElementById('sortBy').value;
        const sortOrder = document.getElementById('sortOrder').value;
        
        if (fieldItems.length === 0) {
          alert('Por favor selecciona al menos un campo para el reporte');
          return;
        }

        const selectedFieldsList = Array.from(fieldItems).map(item => item.dataset.field);
        
        // Show loading state
        const generateBtn = document.getElementById('generateBtn');
        const originalText = generateBtn.textContent;
        generateBtn.textContent = 'Generando...';
        generateBtn.disabled = true;

        // Simulate report generation
        setTimeout(() => {
          alert(`Reporte generado exitosamente!\n\nCampos incluidos: ${selectedFieldsList.join(', ')}\nFormato: ${exportFormat.toUpperCase()}\nOrdenado por: ${sortBy} (${sortOrder})\n\nEl archivo se descargará automáticamente.`);
          
          // Reset button
          generateBtn.textContent = originalText;
          generateBtn.disabled = false;
        }, 2000);
      }

      function logout() {
        if (confirm('¿Estás seguro de que quieres cerrar sesión?')) {
          window.location.href = './index.html';
        }
      }
    </script>
  </body>
</html>

